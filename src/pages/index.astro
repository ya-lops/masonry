---
import BaseLayout from "@/layouts/BaseLayout.astro";

const getImages = import.meta.glob("@/images/*", { eager: true });
const images = Object.values(getImages as {[key: string]: {default: any}}).map((image) => image.default);
const minGridRowPart = 25;
---

<BaseLayout title="Masonry">
  <div class="container">
    <section class="masonry">
      {
        images.map((image) => {
          let rows = Math.round(image.height / minGridRowPart);

          return (
            <div
              class:list={[
                "masonry__item",
                { "is-Portrait": (image.width / image.height) < 9/16 },
              ]}
              style={{ gridRowEnd: `span ${rows}` }}
            >
              <img src={image.src} />
            </div>
          );
        })
      }
    </section>
  </div>
</BaseLayout>

<style lang="scss">
  .masonry {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(270px, 1fr));
    gap: 0.5rem;
    grid-auto-flow: row dense;

    &__item {
      @media (width > 640px) {
        &.is-Portrait {
          grid-column: 2/3;
        }
      }

      img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 5px;
      }
    }
  }
</style>
